{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":29,"index":29}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":30},"end":{"line":2,"column":69,"index":99}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"@react-native-community/netinfo","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":100},"end":{"line":3,"column":54,"index":154}}],"key":"PqZcYTlMIVnzFjdViPzMiGUu7Hg=","exportNames":["*"],"imports":1}},{"name":"../api/inspector","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":155},"end":{"line":4,"column":71,"index":226}}],"key":"hXkUgtl2ZlL9RLsQw35xpd7L9gw=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useOfflineQueue\", {\n    enumerable: true,\n    get: function () {\n      return useOfflineQueue;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var create = _interopDefault(_zustand);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactNativeCommunityNetinfo = require(_dependencyMap[2], \"@react-native-community/netinfo\");\n  var NetInfo = _interopDefault(_reactNativeCommunityNetinfo);\n  var _apiInspector = require(_dependencyMap[3], \"../api/inspector\");\n  const STORAGE_KEY = \"meatsafe_offline_seizures\";\n  const useOfflineQueue = (0, create.default)((set, get) => {\n    // Abonnement réseau\n    NetInfo.default.addEventListener(state => {\n      const online = !!state.isConnected && !!state.isInternetReachable;\n      set({\n        isOnline: online\n      });\n      if (online) {\n        void get().syncAll();\n      }\n    });\n    const loadFromStorage = async () => {\n      try {\n        const stored = await AsyncStorage.default.getItem(STORAGE_KEY);\n        if (stored) {\n          const parsed = JSON.parse(stored);\n          set({\n            items: parsed\n          });\n        }\n      } catch (e) {\n        // ignore pour MVP\n      }\n    };\n    const persist = async items => {\n      try {\n        await AsyncStorage.default.setItem(STORAGE_KEY, JSON.stringify(items));\n      } catch (e) {\n        // ignore\n      }\n    };\n    const addPending = payload => {\n      const localId = `local-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n      const newItem = {\n        localId,\n        payload,\n        status: \"pending\"\n      };\n      set(state => {\n        const next = [...state.items, newItem];\n        void persist(next);\n        return {\n          items: next\n        };\n      });\n    };\n    const markSynced = localId => {\n      set(state => {\n        const next = state.items.filter(i => i.localId !== localId);\n        void persist(next);\n        return {\n          items: next\n        };\n      });\n    };\n    const markFailed = (localId, error) => {\n      set(state => {\n        const next = state.items.map(i => i.localId === localId ? {\n          ...i,\n          status: \"failed\",\n          error\n        } : i);\n        void persist(next);\n        return {\n          items: next\n        };\n      });\n    };\n    const syncAll = async () => {\n      const {\n        items\n      } = get();\n      for (const item of items) {\n        if (item.status !== \"pending\") continue;\n        try {\n          await (0, _apiInspector.createSeizure)(item.payload);\n          get().markSynced(item.localId);\n        } catch (e) {\n          get().markFailed(item.localId, \"Erreur de synchronisation\");\n        }\n      }\n    };\n\n    // état initial\n    void loadFromStorage();\n    return {\n      items: [],\n      isOnline: true,\n      addPending,\n      markSynced,\n      markFailed,\n      loadFromStorage,\n      syncAll\n    };\n  });\n});","lineCount":121,"map":[[12,2,27,0,"Object"],[12,8,27,0],[12,9,27,0,"defineProperty"],[12,23,27,0],[12,24,27,0,"exports"],[12,31,27,0],[13,4,27,0,"enumerable"],[13,14,27,0],[14,4,27,0,"get"],[14,7,27,0],[14,18,27,0,"get"],[14,19,27,0],[15,6,27,0],[15,13,27,0,"useOfflineQueue"],[15,28,27,0],[16,4,27,0],[17,2,27,0],[18,2,1,0],[18,6,1,0,"_zustand"],[18,14,1,0],[18,17,1,0,"require"],[18,24,1,0],[18,25,1,0,"_dependencyMap"],[18,39,1,0],[19,2,1,0],[19,6,1,0,"create"],[19,12,1,0],[19,15,1,0,"_interopDefault"],[19,30,1,0],[19,31,1,0,"_zustand"],[19,39,1,0],[20,2,2,0],[20,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,42,2,0],[20,45,2,0,"require"],[20,52,2,0],[20,53,2,0,"_dependencyMap"],[20,67,2,0],[21,2,2,0],[21,6,2,0,"AsyncStorage"],[21,18,2,0],[21,21,2,0,"_interopDefault"],[21,36,2,0],[21,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[21,73,2,0],[22,2,3,0],[22,6,3,0,"_reactNativeCommunityNetinfo"],[22,34,3,0],[22,37,3,0,"require"],[22,44,3,0],[22,45,3,0,"_dependencyMap"],[22,59,3,0],[23,2,3,0],[23,6,3,0,"NetInfo"],[23,13,3,0],[23,16,3,0,"_interopDefault"],[23,31,3,0],[23,32,3,0,"_reactNativeCommunityNetinfo"],[23,60,3,0],[24,2,4,0],[24,6,4,0,"_apiInspector"],[24,19,4,0],[24,22,4,0,"require"],[24,29,4,0],[24,30,4,0,"_dependencyMap"],[24,44,4,0],[25,2,25,0],[25,8,25,6,"STORAGE_KEY"],[25,19,25,17],[25,22,25,20],[25,49,25,47],[26,2,27,7],[26,8,27,13,"useOfflineQueue"],[26,23,27,28],[26,26,27,31],[26,30,27,31,"create"],[26,36,27,37],[26,37,27,37,"default"],[26,44,27,37],[26,46,27,57],[26,47,27,58,"set"],[26,50,27,61],[26,52,27,63,"get"],[26,55,27,66],[26,60,27,71],[27,4,28,2],[28,4,29,2,"NetInfo"],[28,11,29,9],[28,12,29,9,"default"],[28,19,29,9],[28,20,29,10,"addEventListener"],[28,36,29,26],[28,37,29,28,"state"],[28,42,29,33],[28,46,29,38],[29,6,30,4],[29,12,30,10,"online"],[29,18,30,16],[29,21,30,19],[29,22,30,20],[29,23,30,21,"state"],[29,28,30,26],[29,29,30,27,"isConnected"],[29,40,30,38],[29,44,30,42],[29,45,30,43],[29,46,30,44,"state"],[29,51,30,49],[29,52,30,50,"isInternetReachable"],[29,71,30,69],[30,6,31,4,"set"],[30,9,31,7],[30,10,31,8],[31,8,31,10,"isOnline"],[31,16,31,18],[31,18,31,20,"online"],[32,6,31,27],[32,7,31,28],[32,8,31,29],[33,6,32,4],[33,10,32,8,"online"],[33,16,32,14],[33,18,32,16],[34,8,33,6],[34,13,33,11,"get"],[34,16,33,14],[34,17,33,15],[34,18,33,16],[34,19,33,17,"syncAll"],[34,26,33,24],[34,27,33,25],[34,28,33,26],[35,6,34,4],[36,4,35,2],[36,5,35,3],[36,6,35,4],[37,4,37,2],[37,10,37,8,"loadFromStorage"],[37,25,37,23],[37,28,37,26],[37,34,37,26,"loadFromStorage"],[37,35,37,26],[37,40,37,38],[38,6,38,4],[38,10,38,8],[39,8,39,6],[39,14,39,12,"stored"],[39,20,39,18],[39,23,39,21],[39,29,39,27,"AsyncStorage"],[39,41,39,39],[39,42,39,39,"default"],[39,49,39,39],[39,50,39,40,"getItem"],[39,57,39,47],[39,58,39,48,"STORAGE_KEY"],[39,69,39,59],[39,70,39,60],[40,8,40,6],[40,12,40,10,"stored"],[40,18,40,16],[40,20,40,18],[41,10,41,8],[41,16,41,14,"parsed"],[41,22,41,38],[41,25,41,41,"JSON"],[41,29,41,45],[41,30,41,46,"parse"],[41,35,41,51],[41,36,41,52,"stored"],[41,42,41,58],[41,43,41,59],[42,10,42,8,"set"],[42,13,42,11],[42,14,42,12],[43,12,42,14,"items"],[43,17,42,19],[43,19,42,21,"parsed"],[44,10,42,28],[44,11,42,29],[44,12,42,30],[45,8,43,6],[46,6,44,4],[46,7,44,5],[46,8,44,6],[46,15,44,13,"e"],[46,16,44,14],[46,18,44,16],[47,8,45,6],[48,6,45,6],[49,4,47,2],[49,5,47,3],[50,4,49,2],[50,10,49,8,"persist"],[50,17,49,15],[50,20,49,18],[50,26,49,25,"items"],[50,31,49,48],[50,35,49,53],[51,6,50,4],[51,10,50,8],[52,8,51,6],[52,14,51,12,"AsyncStorage"],[52,26,51,24],[52,27,51,24,"default"],[52,34,51,24],[52,35,51,25,"setItem"],[52,42,51,32],[52,43,51,33,"STORAGE_KEY"],[52,54,51,44],[52,56,51,46,"JSON"],[52,60,51,50],[52,61,51,51,"stringify"],[52,70,51,60],[52,71,51,61,"items"],[52,76,51,66],[52,77,51,67],[52,78,51,68],[53,6,52,4],[53,7,52,5],[53,8,52,6],[53,15,52,13,"e"],[53,16,52,14],[53,18,52,16],[54,8,53,6],[55,6,53,6],[56,4,55,2],[56,5,55,3],[57,4,57,2],[57,10,57,8,"addPending"],[57,20,57,18],[57,23,57,22,"payload"],[57,30,57,51],[57,34,57,56],[58,6,58,4],[58,12,58,10,"localId"],[58,19,58,17],[58,22,58,20],[58,31,58,29,"Date"],[58,35,58,33],[58,36,58,34,"now"],[58,39,58,37],[58,40,58,38],[58,41,58,39],[58,45,58,43,"Math"],[58,49,58,47],[58,50,58,48,"random"],[58,56,58,54],[58,57,58,55],[58,58,58,56],[58,59,58,57,"toString"],[58,67,58,65],[58,68,58,66],[58,70,58,68],[58,71,58,69],[58,72,58,70,"slice"],[58,77,58,75],[58,78,58,76],[58,79,58,77],[58,81,58,79],[58,82,58,80],[58,83,58,81],[58,85,58,83],[59,6,59,4],[59,12,59,10,"newItem"],[59,19,59,33],[59,22,59,36],[60,8,60,6,"localId"],[60,15,60,13],[61,8,61,6,"payload"],[61,15,61,13],[62,8,62,6,"status"],[62,14,62,12],[62,16,62,14],[63,6,63,4],[63,7,63,5],[64,6,64,4,"set"],[64,9,64,7],[64,10,64,9,"state"],[64,15,64,14],[64,19,64,19],[65,8,65,6],[65,14,65,12,"next"],[65,18,65,16],[65,21,65,19],[65,22,65,20],[65,25,65,23,"state"],[65,30,65,28],[65,31,65,29,"items"],[65,36,65,34],[65,38,65,36,"newItem"],[65,45,65,43],[65,46,65,44],[66,8,66,6],[66,13,66,11,"persist"],[66,20,66,18],[66,21,66,19,"next"],[66,25,66,23],[66,26,66,24],[67,8,67,6],[67,15,67,13],[68,10,67,15,"items"],[68,15,67,20],[68,17,67,22,"next"],[69,8,67,27],[69,9,67,28],[70,6,68,4],[70,7,68,5],[70,8,68,6],[71,4,69,2],[71,5,69,3],[72,4,71,2],[72,10,71,8,"markSynced"],[72,20,71,18],[72,23,71,22,"localId"],[72,30,71,37],[72,34,71,42],[73,6,72,4,"set"],[73,9,72,7],[73,10,72,9,"state"],[73,15,72,14],[73,19,72,19],[74,8,73,6],[74,14,73,12,"next"],[74,18,73,16],[74,21,73,19,"state"],[74,26,73,24],[74,27,73,25,"items"],[74,32,73,30],[74,33,73,31,"filter"],[74,39,73,37],[74,40,73,39,"i"],[74,41,73,40],[74,45,73,45,"i"],[74,46,73,46],[74,47,73,47,"localId"],[74,54,73,54],[74,59,73,59,"localId"],[74,66,73,66],[74,67,73,67],[75,8,74,6],[75,13,74,11,"persist"],[75,20,74,18],[75,21,74,19,"next"],[75,25,74,23],[75,26,74,24],[76,8,75,6],[76,15,75,13],[77,10,75,15,"items"],[77,15,75,20],[77,17,75,22,"next"],[78,8,75,27],[78,9,75,28],[79,6,76,4],[79,7,76,5],[79,8,76,6],[80,4,77,2],[80,5,77,3],[81,4,79,2],[81,10,79,8,"markFailed"],[81,20,79,18],[81,23,79,21,"markFailed"],[81,24,79,22,"localId"],[81,31,79,37],[81,33,79,39,"error"],[81,38,79,53],[81,43,79,58],[82,6,80,4,"set"],[82,9,80,7],[82,10,80,9,"state"],[82,15,80,14],[82,19,80,19],[83,8,81,6],[83,14,81,12,"next"],[83,18,81,16],[83,21,81,19,"state"],[83,26,81,24],[83,27,81,25,"items"],[83,32,81,30],[83,33,81,31,"map"],[83,36,81,34],[83,37,81,36,"i"],[83,38,81,37],[83,42,82,8,"i"],[83,43,82,9],[83,44,82,10,"localId"],[83,51,82,17],[83,56,82,22,"localId"],[83,63,82,29],[83,66,82,32],[84,10,82,34],[84,13,82,37,"i"],[84,14,82,38],[85,10,82,40,"status"],[85,16,82,46],[85,18,82,48],[85,26,82,56],[86,10,82,58,"error"],[87,8,82,64],[87,9,82,65],[87,12,82,68,"i"],[87,13,83,6],[87,14,83,7],[88,8,84,6],[88,13,84,11,"persist"],[88,20,84,18],[88,21,84,19,"next"],[88,25,84,23],[88,26,84,24],[89,8,85,6],[89,15,85,13],[90,10,85,15,"items"],[90,15,85,20],[90,17,85,22,"next"],[91,8,85,27],[91,9,85,28],[92,6,86,4],[92,7,86,5],[92,8,86,6],[93,4,87,2],[93,5,87,3],[94,4,89,2],[94,10,89,8,"syncAll"],[94,17,89,15],[94,20,89,18],[94,26,89,18,"syncAll"],[94,27,89,18],[94,32,89,30],[95,6,90,4],[95,12,90,10],[96,8,90,12,"items"],[97,6,90,18],[97,7,90,19],[97,10,90,22,"get"],[97,13,90,25],[97,14,90,26],[97,15,90,27],[98,6,91,4],[98,11,91,9],[98,17,91,15,"item"],[98,21,91,19],[98,25,91,23,"items"],[98,30,91,28],[98,32,91,30],[99,8,92,6],[99,12,92,10,"item"],[99,16,92,14],[99,17,92,15,"status"],[99,23,92,21],[99,28,92,26],[99,37,92,35],[99,39,92,37],[100,8,93,6],[100,12,93,10],[101,10,94,8],[101,16,94,14],[101,20,94,14,"createSeizure"],[101,33,94,27],[101,34,94,27,"createSeizure"],[101,47,94,27],[101,49,94,28,"item"],[101,53,94,32],[101,54,94,33,"payload"],[101,61,94,40],[101,62,94,41],[102,10,95,8,"get"],[102,13,95,11],[102,14,95,12],[102,15,95,13],[102,16,95,14,"markSynced"],[102,26,95,24],[102,27,95,25,"item"],[102,31,95,29],[102,32,95,30,"localId"],[102,39,95,37],[102,40,95,38],[103,8,96,6],[103,9,96,7],[103,10,96,8],[103,17,96,15,"e"],[103,18,96,16],[103,20,96,18],[104,10,97,8,"get"],[104,13,97,11],[104,14,97,12],[104,15,97,13],[104,16,97,14,"markFailed"],[104,26,97,24],[104,27,97,25,"item"],[104,31,97,29],[104,32,97,30,"localId"],[104,39,97,37],[104,41,97,39],[104,68,97,66],[104,69,97,67],[105,8,98,6],[106,6,99,4],[107,4,100,2],[107,5,100,3],[109,4,102,2],[110,4,103,2],[110,9,103,7,"loadFromStorage"],[110,24,103,22],[110,25,103,23],[110,26,103,24],[111,4,105,2],[111,11,105,9],[112,6,106,4,"items"],[112,11,106,9],[112,13,106,11],[112,15,106,13],[113,6,107,4,"isOnline"],[113,14,107,12],[113,16,107,14],[113,20,107,18],[114,6,108,4,"addPending"],[114,16,108,14],[115,6,109,4,"markSynced"],[115,16,109,14],[116,6,110,4,"markFailed"],[116,16,110,14],[117,6,111,4,"loadFromStorage"],[117,21,111,19],[118,6,112,4,"syncAll"],[119,4,113,2],[119,5,113,3],[120,2,114,0],[120,3,114,1],[120,4,114,2],[121,0,114,3],[121,3]],"functionMap":{"names":["<global>","create$argument_0","NetInfo.addEventListener$argument_0","loadFromStorage","persist","addPending","set$argument_0","markSynced","state.items.filter$argument_0","markFailed","state.items.map$argument_0","syncAll"],"mappings":"AAA;yDC0B;2BCE;GDM;0BEE;GFU;kBGE;GHM;qBIE;QCO;KDI;GJC;qBME;QDC;sCEC,4BF;KCG;GNC;qBQE;QHC;mCIC;qEJC;KGI;GRC;kBUE;GVW;CDc"},"hasCjsExports":false},"type":"js/module"}]}
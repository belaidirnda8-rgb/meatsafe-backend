{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":87,"index":87}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":88},"end":{"line":2,"column":69,"index":157}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../api/client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":158},"end":{"line":3,"column":50,"index":208}}],"key":"vrY6iF+Nd2CrRu9d6eBxeX1BPiA=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _apiClient = require(_dependencyMap[2], \"../api/client\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const STORAGE_KEY_TOKEN = \"meatsafe_token\";\n  const STORAGE_KEY_USER = \"meatsafe_user\";\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      const init = async () => {\n        try {\n          const [storedToken, storedUser] = await Promise.all([AsyncStorage.default.getItem(STORAGE_KEY_TOKEN), AsyncStorage.default.getItem(STORAGE_KEY_USER)]);\n          if (storedToken && storedUser) {\n            setToken(storedToken);\n            (0, _apiClient.setAuthToken)(storedToken);\n            setUser(JSON.parse(storedUser));\n          }\n        } catch (error) {\n          console.warn(\"Erreur lors du chargement du token\", error);\n        } finally {\n          setLoading(false);\n        }\n      };\n      void init();\n    }, []);\n    const login = async ({\n      email,\n      password\n    }) => {\n      try {\n        const formData = new URLSearchParams();\n        formData.append(\"username\", email);\n        formData.append(\"password\", password);\n        const response = await _apiClient.api.post(\"/auth/login\", formData.toString(), {\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          }\n        });\n        const {\n          access_token,\n          user: userData\n        } = response.data;\n        setToken(access_token);\n        (0, _apiClient.setAuthToken)(access_token);\n        setUser(userData);\n        await Promise.all([AsyncStorage.default.setItem(STORAGE_KEY_TOKEN, access_token), AsyncStorage.default.setItem(STORAGE_KEY_USER, JSON.stringify(userData))]);\n      } catch (error) {\n        console.error(\"Erreur de connexion\", error);\n        throw error;\n      }\n    };\n    const logout = async () => {\n      setUser(null);\n      setToken(null);\n      (0, _apiClient.setAuthToken)(null);\n      await Promise.all([AsyncStorage.default.removeItem(STORAGE_KEY_TOKEN), AsyncStorage.default.removeItem(STORAGE_KEY_USER)]);\n    };\n    const value = (0, _react.useMemo)(() => ({\n      user,\n      token,\n      loading,\n      login,\n      logout\n    }), [user, token, loading]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 10\n    }, this);\n  };\n  const useAuth = () => {\n    const ctx = (0, _react.useContext)(AuthContext);\n    if (!ctx) {\n      throw new Error(\"useAuth doit être utilisé dans un AuthProvider\");\n    }\n    return ctx;\n  };\n});","lineCount":111,"map":[[13,2,32,0,"Object"],[13,8,32,0],[13,9,32,0,"defineProperty"],[13,23,32,0],[13,24,32,0,"exports"],[13,31,32,0],[14,4,32,0,"enumerable"],[14,14,32,0],[15,4,32,0,"get"],[15,7,32,0],[15,18,32,0,"get"],[15,19,32,0],[16,6,32,0],[16,13,32,0,"AuthProvider"],[16,25,32,0],[17,4,32,0],[18,2,32,0],[19,2,103,0,"Object"],[19,8,103,0],[19,9,103,0,"defineProperty"],[19,23,103,0],[19,24,103,0,"exports"],[19,31,103,0],[20,4,103,0,"enumerable"],[20,14,103,0],[21,4,103,0,"get"],[21,7,103,0],[21,18,103,0,"get"],[21,19,103,0],[22,6,103,0],[22,13,103,0,"useAuth"],[22,20,103,0],[23,4,103,0],[24,2,103,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,3,0],[28,6,3,0,"_apiClient"],[28,16,3,0],[28,19,3,0,"require"],[28,26,3,0],[28,27,3,0,"_dependencyMap"],[28,41,3,0],[29,2,3,50],[29,6,3,50,"_reactJsxDevRuntime"],[29,25,3,50],[29,28,3,50,"require"],[29,35,3,50],[29,36,3,50,"_dependencyMap"],[29,50,3,50],[30,2,27,0],[30,8,27,6,"AuthContext"],[30,19,27,17],[30,35,27,20],[30,39,27,20,"createContext"],[30,45,27,33],[30,46,27,33,"createContext"],[30,59,27,33],[30,61,27,64,"undefined"],[30,70,27,73],[30,71,27,74],[31,2,29,0],[31,8,29,6,"STORAGE_KEY_TOKEN"],[31,25,29,23],[31,28,29,26],[31,44,29,42],[32,2,30,0],[32,8,30,6,"STORAGE_KEY_USER"],[32,24,30,22],[32,27,30,25],[32,42,30,40],[33,2,32,7],[33,8,32,13,"AuthProvider"],[33,20,32,66],[33,23,32,69,"AuthProvider"],[33,24,32,70],[34,4,32,72,"children"],[35,2,32,81],[35,3,32,82],[35,8,32,87],[36,4,33,2],[36,10,33,8],[36,11,33,9,"user"],[36,15,33,13],[36,17,33,15,"setUser"],[36,24,33,22],[36,25,33,23],[36,28,33,26],[36,32,33,26,"useState"],[36,38,33,34],[36,39,33,34,"useState"],[36,47,33,34],[36,49,33,52],[36,53,33,56],[36,54,33,57],[37,4,34,2],[37,10,34,8],[37,11,34,9,"token"],[37,16,34,14],[37,18,34,16,"setToken"],[37,26,34,24],[37,27,34,25],[37,30,34,28],[37,34,34,28,"useState"],[37,40,34,36],[37,41,34,36,"useState"],[37,49,34,36],[37,51,34,52],[37,55,34,56],[37,56,34,57],[38,4,35,2],[38,10,35,8],[38,11,35,9,"loading"],[38,18,35,16],[38,20,35,18,"setLoading"],[38,30,35,28],[38,31,35,29],[38,34,35,32],[38,38,35,32,"useState"],[38,44,35,40],[38,45,35,40,"useState"],[38,53,35,40],[38,55,35,41],[38,59,35,45],[38,60,35,46],[39,4,37,2],[39,8,37,2,"useEffect"],[39,14,37,11],[39,15,37,11,"useEffect"],[39,24,37,11],[39,26,37,12],[39,32,37,18],[40,6,38,4],[40,12,38,10,"init"],[40,16,38,14],[40,19,38,17],[40,25,38,17,"init"],[40,26,38,17],[40,31,38,29],[41,8,39,6],[41,12,39,10],[42,10,40,8],[42,16,40,14],[42,17,40,15,"storedToken"],[42,28,40,26],[42,30,40,28,"storedUser"],[42,40,40,38],[42,41,40,39],[42,44,40,42],[42,50,40,48,"Promise"],[42,57,40,55],[42,58,40,56,"all"],[42,61,40,59],[42,62,40,60],[42,63,41,10,"AsyncStorage"],[42,75,41,22],[42,76,41,22,"default"],[42,83,41,22],[42,84,41,23,"getItem"],[42,91,41,30],[42,92,41,31,"STORAGE_KEY_TOKEN"],[42,109,41,48],[42,110,41,49],[42,112,42,10,"AsyncStorage"],[42,124,42,22],[42,125,42,22,"default"],[42,132,42,22],[42,133,42,23,"getItem"],[42,140,42,30],[42,141,42,31,"STORAGE_KEY_USER"],[42,157,42,47],[42,158,42,48],[42,159,43,9],[42,160,43,10],[43,10,45,8],[43,14,45,12,"storedToken"],[43,25,45,23],[43,29,45,27,"storedUser"],[43,39,45,37],[43,41,45,39],[44,12,46,10,"setToken"],[44,20,46,18],[44,21,46,19,"storedToken"],[44,32,46,30],[44,33,46,31],[45,12,47,10],[45,16,47,10,"setAuthToken"],[45,26,47,22],[45,27,47,22,"setAuthToken"],[45,39,47,22],[45,41,47,23,"storedToken"],[45,52,47,34],[45,53,47,35],[46,12,48,10,"setUser"],[46,19,48,17],[46,20,48,18,"JSON"],[46,24,48,22],[46,25,48,23,"parse"],[46,30,48,28],[46,31,48,29,"storedUser"],[46,41,48,39],[46,42,48,40],[46,43,48,41],[47,10,49,8],[48,8,50,6],[48,9,50,7],[48,10,50,8],[48,17,50,15,"error"],[48,22,50,20],[48,24,50,22],[49,10,51,8,"console"],[49,17,51,15],[49,18,51,16,"warn"],[49,22,51,20],[49,23,51,21],[49,59,51,57],[49,61,51,59,"error"],[49,66,51,64],[49,67,51,65],[50,8,52,6],[50,9,52,7],[50,18,52,16],[51,10,53,8,"setLoading"],[51,20,53,18],[51,21,53,19],[51,26,53,24],[51,27,53,25],[52,8,54,6],[53,6,55,4],[53,7,55,5],[54,6,57,4],[54,11,57,9,"init"],[54,15,57,13],[54,16,57,14],[54,17,57,15],[55,4,58,2],[55,5,58,3],[55,7,58,5],[55,9,58,7],[55,10,58,8],[56,4,60,2],[56,10,60,8,"login"],[56,15,60,13],[56,18,60,16],[56,24,60,16,"login"],[56,25,60,23],[57,6,60,25,"email"],[57,11,60,30],[58,6,60,32,"password"],[59,4,60,54],[59,5,60,55],[59,10,60,60],[60,6,61,4],[60,10,61,8],[61,8,62,6],[61,14,62,12,"formData"],[61,22,62,20],[61,25,62,23],[61,29,62,27,"URLSearchParams"],[61,44,62,42],[61,45,62,43],[61,46,62,44],[62,8,63,6,"formData"],[62,16,63,14],[62,17,63,15,"append"],[62,23,63,21],[62,24,63,22],[62,34,63,32],[62,36,63,34,"email"],[62,41,63,39],[62,42,63,40],[63,8,64,6,"formData"],[63,16,64,14],[63,17,64,15,"append"],[63,23,64,21],[63,24,64,22],[63,34,64,32],[63,36,64,34,"password"],[63,44,64,42],[63,45,64,43],[64,8,66,6],[64,14,66,12,"response"],[64,22,66,20],[64,25,66,23],[64,31,66,29,"api"],[64,41,66,32],[64,42,66,32,"api"],[64,45,66,32],[64,46,66,33,"post"],[64,50,66,37],[64,51,66,38],[64,64,66,51],[64,66,66,53,"formData"],[64,74,66,61],[64,75,66,62,"toString"],[64,83,66,70],[64,84,66,71],[64,85,66,72],[64,87,66,74],[65,10,67,8,"headers"],[65,17,67,15],[65,19,67,17],[66,12,67,19],[66,26,67,33],[66,28,67,35],[67,10,67,71],[68,8,68,6],[68,9,68,7],[68,10,68,8],[69,8,70,6],[69,14,70,12],[70,10,70,14,"access_token"],[70,22,70,26],[71,10,70,28,"user"],[71,14,70,32],[71,16,70,34,"userData"],[72,8,70,43],[72,9,70,44],[72,12,70,47,"response"],[72,20,70,55],[72,21,70,56,"data"],[72,25,70,60],[73,8,71,6,"setToken"],[73,16,71,14],[73,17,71,15,"access_token"],[73,29,71,27],[73,30,71,28],[74,8,72,6],[74,12,72,6,"setAuthToken"],[74,22,72,18],[74,23,72,18,"setAuthToken"],[74,35,72,18],[74,37,72,19,"access_token"],[74,49,72,31],[74,50,72,32],[75,8,73,6,"setUser"],[75,15,73,13],[75,16,73,14,"userData"],[75,24,73,22],[75,25,73,23],[76,8,75,6],[76,14,75,12,"Promise"],[76,21,75,19],[76,22,75,20,"all"],[76,25,75,23],[76,26,75,24],[76,27,76,8,"AsyncStorage"],[76,39,76,20],[76,40,76,20,"default"],[76,47,76,20],[76,48,76,21,"setItem"],[76,55,76,28],[76,56,76,29,"STORAGE_KEY_TOKEN"],[76,73,76,46],[76,75,76,48,"access_token"],[76,87,76,60],[76,88,76,61],[76,90,77,8,"AsyncStorage"],[76,102,77,20],[76,103,77,20,"default"],[76,110,77,20],[76,111,77,21,"setItem"],[76,118,77,28],[76,119,77,29,"STORAGE_KEY_USER"],[76,135,77,45],[76,137,77,47,"JSON"],[76,141,77,51],[76,142,77,52,"stringify"],[76,151,77,61],[76,152,77,62,"userData"],[76,160,77,70],[76,161,77,71],[76,162,77,72],[76,163,78,7],[76,164,78,8],[77,6,79,4],[77,7,79,5],[77,8,79,6],[77,15,79,13,"error"],[77,20,79,18],[77,22,79,20],[78,8,80,6,"console"],[78,15,80,13],[78,16,80,14,"error"],[78,21,80,19],[78,22,80,20],[78,43,80,41],[78,45,80,43,"error"],[78,50,80,48],[78,51,80,49],[79,8,81,6],[79,14,81,12,"error"],[79,19,81,17],[80,6,82,4],[81,4,83,2],[81,5,83,3],[82,4,85,2],[82,10,85,8,"logout"],[82,16,85,14],[82,19,85,17],[82,25,85,17,"logout"],[82,26,85,17],[82,31,85,29],[83,6,86,4,"setUser"],[83,13,86,11],[83,14,86,12],[83,18,86,16],[83,19,86,17],[84,6,87,4,"setToken"],[84,14,87,12],[84,15,87,13],[84,19,87,17],[84,20,87,18],[85,6,88,4],[85,10,88,4,"setAuthToken"],[85,20,88,16],[85,21,88,16,"setAuthToken"],[85,33,88,16],[85,35,88,17],[85,39,88,21],[85,40,88,22],[86,6,89,4],[86,12,89,10,"Promise"],[86,19,89,17],[86,20,89,18,"all"],[86,23,89,21],[86,24,89,22],[86,25,90,6,"AsyncStorage"],[86,37,90,18],[86,38,90,18,"default"],[86,45,90,18],[86,46,90,19,"removeItem"],[86,56,90,29],[86,57,90,30,"STORAGE_KEY_TOKEN"],[86,74,90,47],[86,75,90,48],[86,77,91,6,"AsyncStorage"],[86,89,91,18],[86,90,91,18,"default"],[86,97,91,18],[86,98,91,19,"removeItem"],[86,108,91,29],[86,109,91,30,"STORAGE_KEY_USER"],[86,125,91,46],[86,126,91,47],[86,127,92,5],[86,128,92,6],[87,4,93,2],[87,5,93,3],[88,4,95,2],[88,10,95,8,"value"],[88,15,95,13],[88,18,95,16],[88,22,95,16,"useMemo"],[88,28,95,23],[88,29,95,23,"useMemo"],[88,36,95,23],[88,38,96,4],[88,45,96,11],[89,6,96,13,"user"],[89,10,96,17],[90,6,96,19,"token"],[90,11,96,24],[91,6,96,26,"loading"],[91,13,96,33],[92,6,96,35,"login"],[92,11,96,40],[93,6,96,42,"logout"],[94,4,96,49],[94,5,96,50],[94,6,96,51],[94,8,97,4],[94,9,97,5,"user"],[94,13,97,9],[94,15,97,11,"token"],[94,20,97,16],[94,22,97,18,"loading"],[94,29,97,25],[94,30,98,2],[94,31,98,3],[95,4,100,2],[95,24,100,9],[95,28,100,9,"_reactJsxDevRuntime"],[95,47,100,9],[95,48,100,9,"jsxDEV"],[95,54,100,9],[95,56,100,10,"AuthContext"],[95,67,100,21],[95,68,100,22,"Provider"],[95,76,100,30],[96,6,100,31,"value"],[96,11,100,36],[96,13,100,38,"value"],[96,18,100,44],[97,6,100,44,"children"],[97,14,100,44],[97,16,100,46,"children"],[98,4,100,54],[99,6,100,54,"fileName"],[99,14,100,54],[99,16,100,54,"_jsxFileName"],[99,28,100,54],[100,6,100,54,"lineNumber"],[100,16,100,54],[101,6,100,54,"columnNumber"],[101,18,100,54],[102,4,100,54],[102,11,100,77],[102,12,100,78],[103,2,101,0],[103,3,101,1],[104,2,103,7],[104,8,103,13,"useAuth"],[104,15,103,20],[104,18,103,23,"useAuth"],[104,19,103,23],[104,24,103,47],[105,4,104,2],[105,10,104,8,"ctx"],[105,13,104,11],[105,16,104,14],[105,20,104,14,"useContext"],[105,26,104,24],[105,27,104,24,"useContext"],[105,37,104,24],[105,39,104,25,"AuthContext"],[105,50,104,36],[105,51,104,37],[106,4,105,2],[106,8,105,6],[106,9,105,7,"ctx"],[106,12,105,10],[106,14,105,12],[107,6,106,4],[107,12,106,10],[107,16,106,14,"Error"],[107,21,106,19],[107,22,106,20],[107,70,106,68],[107,71,106,69],[108,4,107,2],[109,4,108,2],[109,11,108,9,"ctx"],[109,14,108,12],[110,2,109,0],[110,3,109,1],[111,0,109,2],[111,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","init","login","logout","useMemo$argument_0","useAuth"],"mappings":"AAA;qEC+B;YCK;iBCC;KDiB;GDG;gBGE;GHuB;iBIE;GJQ;IKG,+CL;CDK;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}
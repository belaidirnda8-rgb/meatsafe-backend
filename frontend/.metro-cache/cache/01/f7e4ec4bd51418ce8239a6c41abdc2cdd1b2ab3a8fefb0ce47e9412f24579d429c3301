{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":7,"column":15,"index":98}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":99},"end":{"line":8,"column":69,"index":168}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":169},"end":{"line":9,"column":26,"index":195}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"../api/client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":196},"end":{"line":10,"column":50,"index":246}}],"key":"vrY6iF+Nd2CrRu9d6eBxeX1BPiA=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _apiClient = require(_dependencyMap[3], \"../api/client\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const STORAGE_KEY_TOKEN = \"meatsafe_token\";\n  const STORAGE_KEY_USER = \"meatsafe_user\";\n  const API_URL = \"https://meatsafe-backend-vg5c.onrender.com\";\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n\n    // ðŸ”„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚\n    (0, _react.useEffect)(() => {\n      const init = async () => {\n        try {\n          const [storedToken, storedUser] = await Promise.all([AsyncStorage.default.getItem(STORAGE_KEY_TOKEN), AsyncStorage.default.getItem(STORAGE_KEY_USER)]);\n          if (storedToken && storedUser) {\n            (0, _apiClient.setAuthToken)(storedToken);\n            try {\n              const meRes = await _apiClient.api.get(\"/users/me\");\n              const userData = meRes.data;\n              setToken(storedToken);\n              setUser(userData);\n              await AsyncStorage.default.setItem(STORAGE_KEY_USER, JSON.stringify(userData));\n            } catch {\n              await logout();\n            }\n          }\n        } catch (e) {\n          console.warn(\"Erreur init auth\", e);\n        } finally {\n          setLoading(false);\n        }\n      };\n      init();\n    }, []);\n\n    // ðŸ” LOGIN\n    const login = async ({\n      email,\n      password\n    }) => {\n      const form = new URLSearchParams();\n      form.append(\"grant_type\", \"password\");\n      form.append(\"username\", email.trim());\n      form.append(\"password\", password);\n      const body = form.toString();\n      console.log(`LOGIN URL: ${API_URL}/api/auth/login`);\n      console.log(\"LOGIN BODY:\", body);\n      const res = await axios.default.post(`${API_URL}/api/auth/login`, body, {\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\n          Accept: \"application/json\"\n        }\n      });\n      const {\n        access_token,\n        user: userData\n      } = res.data;\n      setToken(access_token);\n      (0, _apiClient.setAuthToken)(access_token);\n      setUser(userData);\n      await Promise.all([AsyncStorage.default.setItem(STORAGE_KEY_TOKEN, access_token), AsyncStorage.default.setItem(STORAGE_KEY_USER, JSON.stringify(userData))]);\n    };\n\n    // ðŸšª LOGOUT\n    const logout = async () => {\n      setUser(null);\n      setToken(null);\n      (0, _apiClient.setAuthToken)(null);\n      await Promise.all([AsyncStorage.default.removeItem(STORAGE_KEY_TOKEN), AsyncStorage.default.removeItem(STORAGE_KEY_USER)]);\n    };\n    const value = (0, _react.useMemo)(() => ({\n      user,\n      token,\n      loading,\n      login,\n      logout\n    }), [user, token, loading]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 10\n    }, this);\n  };\n  const useAuth = () => {\n    const ctx = (0, _react.useContext)(AuthContext);\n    if (!ctx) {\n      throw new Error(\"useAuth must be used inside AuthProvider\");\n    }\n    return ctx;\n  };\n});","lineCount":127,"map":[[13,2,41,0,"Object"],[13,8,41,0],[13,9,41,0,"defineProperty"],[13,23,41,0],[13,24,41,0,"exports"],[13,31,41,0],[14,4,41,0,"enumerable"],[14,14,41,0],[15,4,41,0,"get"],[15,7,41,0],[15,18,41,0,"get"],[15,19,41,0],[16,6,41,0],[16,13,41,0,"AuthProvider"],[16,25,41,0],[17,4,41,0],[18,2,41,0],[19,2,140,0,"Object"],[19,8,140,0],[19,9,140,0,"defineProperty"],[19,23,140,0],[19,24,140,0,"exports"],[19,31,140,0],[20,4,140,0,"enumerable"],[20,14,140,0],[21,4,140,0,"get"],[21,7,140,0],[21,18,140,0,"get"],[21,19,140,0],[22,6,140,0],[22,13,140,0,"useAuth"],[22,20,140,0],[23,4,140,0],[24,2,140,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,8,0],[26,6,8,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,8,0],[26,45,8,0,"require"],[26,52,8,0],[26,53,8,0,"_dependencyMap"],[26,67,8,0],[27,2,8,0],[27,6,8,0,"AsyncStorage"],[27,18,8,0],[27,21,8,0,"_interopDefault"],[27,36,8,0],[27,37,8,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,8,0],[28,2,9,0],[28,6,9,0,"_axios"],[28,12,9,0],[28,15,9,0,"require"],[28,22,9,0],[28,23,9,0,"_dependencyMap"],[28,37,9,0],[29,2,9,0],[29,6,9,0,"axios"],[29,11,9,0],[29,14,9,0,"_interopDefault"],[29,29,9,0],[29,30,9,0,"_axios"],[29,36,9,0],[30,2,10,0],[30,6,10,0,"_apiClient"],[30,16,10,0],[30,19,10,0,"require"],[30,26,10,0],[30,27,10,0,"_dependencyMap"],[30,41,10,0],[31,2,10,50],[31,6,10,50,"_reactJsxDevRuntime"],[31,25,10,50],[31,28,10,50,"require"],[31,35,10,50],[31,36,10,50,"_dependencyMap"],[31,50,10,50],[32,2,34,0],[32,8,34,6,"AuthContext"],[32,19,34,17],[32,35,34,20],[32,39,34,20,"createContext"],[32,45,34,33],[32,46,34,33,"createContext"],[32,59,34,33],[32,61,34,64,"undefined"],[32,70,34,73],[32,71,34,74],[33,2,36,0],[33,8,36,6,"STORAGE_KEY_TOKEN"],[33,25,36,23],[33,28,36,26],[33,44,36,42],[34,2,37,0],[34,8,37,6,"STORAGE_KEY_USER"],[34,24,37,22],[34,27,37,25],[34,42,37,40],[35,2,39,0],[35,8,39,6,"API_URL"],[35,15,39,13],[35,18,39,16],[35,62,39,60],[36,2,41,7],[36,8,41,13,"AuthProvider"],[36,20,41,66],[36,23,41,69,"AuthProvider"],[36,24,41,70],[37,4,42,2,"children"],[38,2,43,0],[38,3,43,1],[38,8,43,6],[39,4,44,2],[39,10,44,8],[39,11,44,9,"user"],[39,15,44,13],[39,17,44,15,"setUser"],[39,24,44,22],[39,25,44,23],[39,28,44,26],[39,32,44,26,"useState"],[39,38,44,34],[39,39,44,34,"useState"],[39,47,44,34],[39,49,44,52],[39,53,44,56],[39,54,44,57],[40,4,45,2],[40,10,45,8],[40,11,45,9,"token"],[40,16,45,14],[40,18,45,16,"setToken"],[40,26,45,24],[40,27,45,25],[40,30,45,28],[40,34,45,28,"useState"],[40,40,45,36],[40,41,45,36,"useState"],[40,49,45,36],[40,51,45,52],[40,55,45,56],[40,56,45,57],[41,4,46,2],[41,10,46,8],[41,11,46,9,"loading"],[41,18,46,16],[41,20,46,18,"setLoading"],[41,30,46,28],[41,31,46,29],[41,34,46,32],[41,38,46,32,"useState"],[41,44,46,40],[41,45,46,40,"useState"],[41,53,46,40],[41,55,46,41],[41,59,46,45],[41,60,46,46],[43,4,48,2],[44,4,49,2],[44,8,49,2,"useEffect"],[44,14,49,11],[44,15,49,11,"useEffect"],[44,24,49,11],[44,26,49,12],[44,32,49,18],[45,6,50,4],[45,12,50,10,"init"],[45,16,50,14],[45,19,50,17],[45,25,50,17,"init"],[45,26,50,17],[45,31,50,29],[46,8,51,6],[46,12,51,10],[47,10,52,8],[47,16,52,14],[47,17,52,15,"storedToken"],[47,28,52,26],[47,30,52,28,"storedUser"],[47,40,52,38],[47,41,52,39],[47,44,52,42],[47,50,52,48,"Promise"],[47,57,52,55],[47,58,52,56,"all"],[47,61,52,59],[47,62,52,60],[47,63,53,10,"AsyncStorage"],[47,75,53,22],[47,76,53,22,"default"],[47,83,53,22],[47,84,53,23,"getItem"],[47,91,53,30],[47,92,53,31,"STORAGE_KEY_TOKEN"],[47,109,53,48],[47,110,53,49],[47,112,54,10,"AsyncStorage"],[47,124,54,22],[47,125,54,22,"default"],[47,132,54,22],[47,133,54,23,"getItem"],[47,140,54,30],[47,141,54,31,"STORAGE_KEY_USER"],[47,157,54,47],[47,158,54,48],[47,159,55,9],[47,160,55,10],[48,10,57,8],[48,14,57,12,"storedToken"],[48,25,57,23],[48,29,57,27,"storedUser"],[48,39,57,37],[48,41,57,39],[49,12,58,10],[49,16,58,10,"setAuthToken"],[49,26,58,22],[49,27,58,22,"setAuthToken"],[49,39,58,22],[49,41,58,23,"storedToken"],[49,52,58,34],[49,53,58,35],[50,12,60,10],[50,16,60,14],[51,14,61,12],[51,20,61,18,"meRes"],[51,25,61,23],[51,28,61,26],[51,34,61,32,"api"],[51,44,61,35],[51,45,61,35,"api"],[51,48,61,35],[51,49,61,36,"get"],[51,52,61,39],[51,53,61,40],[51,64,61,51],[51,65,61,52],[52,14,62,12],[52,20,62,18,"userData"],[52,28,62,26],[52,31,62,29,"meRes"],[52,36,62,34],[52,37,62,35,"data"],[52,41,62,51],[53,14,64,12,"setToken"],[53,22,64,20],[53,23,64,21,"storedToken"],[53,34,64,32],[53,35,64,33],[54,14,65,12,"setUser"],[54,21,65,19],[54,22,65,20,"userData"],[54,30,65,28],[54,31,65,29],[55,14,67,12],[55,20,67,18,"AsyncStorage"],[55,32,67,30],[55,33,67,30,"default"],[55,40,67,30],[55,41,67,31,"setItem"],[55,48,67,38],[55,49,68,14,"STORAGE_KEY_USER"],[55,65,68,30],[55,67,69,14,"JSON"],[55,71,69,18],[55,72,69,19,"stringify"],[55,81,69,28],[55,82,69,29,"userData"],[55,90,69,37],[55,91,70,12],[55,92,70,13],[56,12,71,10],[56,13,71,11],[56,14,71,12],[56,20,71,18],[57,14,72,12],[57,20,72,18,"logout"],[57,26,72,24],[57,27,72,25],[57,28,72,26],[58,12,73,10],[59,10,74,8],[60,8,75,6],[60,9,75,7],[60,10,75,8],[60,17,75,15,"e"],[60,18,75,16],[60,20,75,18],[61,10,76,8,"console"],[61,17,76,15],[61,18,76,16,"warn"],[61,22,76,20],[61,23,76,21],[61,41,76,39],[61,43,76,41,"e"],[61,44,76,42],[61,45,76,43],[62,8,77,6],[62,9,77,7],[62,18,77,16],[63,10,78,8,"setLoading"],[63,20,78,18],[63,21,78,19],[63,26,78,24],[63,27,78,25],[64,8,79,6],[65,6,80,4],[65,7,80,5],[66,6,82,4,"init"],[66,10,82,8],[66,11,82,9],[66,12,82,10],[67,4,83,2],[67,5,83,3],[67,7,83,5],[67,9,83,7],[67,10,83,8],[69,4,85,2],[70,4,86,2],[70,10,86,8,"login"],[70,15,86,13],[70,18,86,16],[70,24,86,16,"login"],[70,25,86,23],[71,6,86,25,"email"],[71,11,86,30],[72,6,86,32,"password"],[73,4,86,54],[73,5,86,55],[73,10,86,60],[74,6,87,4],[74,12,87,10,"form"],[74,16,87,14],[74,19,87,17],[74,23,87,21,"URLSearchParams"],[74,38,87,36],[74,39,87,37],[74,40,87,38],[75,6,88,4,"form"],[75,10,88,8],[75,11,88,9,"append"],[75,17,88,15],[75,18,88,16],[75,30,88,28],[75,32,88,30],[75,42,88,40],[75,43,88,41],[76,6,89,4,"form"],[76,10,89,8],[76,11,89,9,"append"],[76,17,89,15],[76,18,89,16],[76,28,89,26],[76,30,89,28,"email"],[76,35,89,33],[76,36,89,34,"trim"],[76,40,89,38],[76,41,89,39],[76,42,89,40],[76,43,89,41],[77,6,90,4,"form"],[77,10,90,8],[77,11,90,9,"append"],[77,17,90,15],[77,18,90,16],[77,28,90,26],[77,30,90,28,"password"],[77,38,90,36],[77,39,90,37],[78,6,92,0],[78,12,92,6,"body"],[78,16,92,10],[78,19,92,13,"form"],[78,23,92,17],[78,24,92,18,"toString"],[78,32,92,26],[78,33,92,27],[78,34,92,28],[79,6,94,0,"console"],[79,13,94,7],[79,14,94,8,"log"],[79,17,94,11],[79,18,94,14],[79,32,94,28,"API_URL"],[79,39,94,35],[79,56,94,52],[79,57,94,53],[80,6,95,0,"console"],[80,13,95,7],[80,14,95,8,"log"],[80,17,95,11],[80,18,95,12],[80,31,95,25],[80,33,95,27,"body"],[80,37,95,31],[80,38,95,32],[81,6,97,0],[81,12,97,6,"res"],[81,15,97,9],[81,18,97,12],[81,24,97,18,"axios"],[81,29,97,23],[81,30,97,23,"default"],[81,37,97,23],[81,38,97,24,"post"],[81,42,97,28],[81,43,98,2],[81,46,98,5,"API_URL"],[81,53,98,12],[81,70,98,29],[81,72,99,2,"body"],[81,76,99,6],[81,78,100,2],[82,8,101,4,"headers"],[82,15,101,11],[82,17,101,13],[83,10,102,6],[83,24,102,20],[83,26,102,22],[83,61,102,57],[84,10,103,6,"Accept"],[84,16,103,12],[84,18,103,14],[85,8,104,4],[86,6,105,2],[86,7,106,0],[86,8,106,1],[87,6,108,4],[87,12,108,10],[88,8,108,12,"access_token"],[88,20,108,24],[89,8,108,26,"user"],[89,12,108,30],[89,14,108,32,"userData"],[90,6,108,41],[90,7,108,42],[90,10,108,45,"res"],[90,13,108,48],[90,14,108,49,"data"],[90,18,108,53],[91,6,110,4,"setToken"],[91,14,110,12],[91,15,110,13,"access_token"],[91,27,110,25],[91,28,110,26],[92,6,111,4],[92,10,111,4,"setAuthToken"],[92,20,111,16],[92,21,111,16,"setAuthToken"],[92,33,111,16],[92,35,111,17,"access_token"],[92,47,111,29],[92,48,111,30],[93,6,112,4,"setUser"],[93,13,112,11],[93,14,112,12,"userData"],[93,22,112,20],[93,23,112,21],[94,6,114,4],[94,12,114,10,"Promise"],[94,19,114,17],[94,20,114,18,"all"],[94,23,114,21],[94,24,114,22],[94,25,115,6,"AsyncStorage"],[94,37,115,18],[94,38,115,18,"default"],[94,45,115,18],[94,46,115,19,"setItem"],[94,53,115,26],[94,54,115,27,"STORAGE_KEY_TOKEN"],[94,71,115,44],[94,73,115,46,"access_token"],[94,85,115,58],[94,86,115,59],[94,88,116,6,"AsyncStorage"],[94,100,116,18],[94,101,116,18,"default"],[94,108,116,18],[94,109,116,19,"setItem"],[94,116,116,26],[94,117,116,27,"STORAGE_KEY_USER"],[94,133,116,43],[94,135,116,45,"JSON"],[94,139,116,49],[94,140,116,50,"stringify"],[94,149,116,59],[94,150,116,60,"userData"],[94,158,116,68],[94,159,116,69],[94,160,116,70],[94,161,117,5],[94,162,117,6],[95,4,118,2],[95,5,118,3],[97,4,120,2],[98,4,121,2],[98,10,121,8,"logout"],[98,16,121,14],[98,19,121,17],[98,25,121,17,"logout"],[98,26,121,17],[98,31,121,29],[99,6,122,4,"setUser"],[99,13,122,11],[99,14,122,12],[99,18,122,16],[99,19,122,17],[100,6,123,4,"setToken"],[100,14,123,12],[100,15,123,13],[100,19,123,17],[100,20,123,18],[101,6,124,4],[101,10,124,4,"setAuthToken"],[101,20,124,16],[101,21,124,16,"setAuthToken"],[101,33,124,16],[101,35,124,17],[101,39,124,21],[101,40,124,22],[102,6,126,4],[102,12,126,10,"Promise"],[102,19,126,17],[102,20,126,18,"all"],[102,23,126,21],[102,24,126,22],[102,25,127,6,"AsyncStorage"],[102,37,127,18],[102,38,127,18,"default"],[102,45,127,18],[102,46,127,19,"removeItem"],[102,56,127,29],[102,57,127,30,"STORAGE_KEY_TOKEN"],[102,74,127,47],[102,75,127,48],[102,77,128,6,"AsyncStorage"],[102,89,128,18],[102,90,128,18,"default"],[102,97,128,18],[102,98,128,19,"removeItem"],[102,108,128,29],[102,109,128,30,"STORAGE_KEY_USER"],[102,125,128,46],[102,126,128,47],[102,127,129,5],[102,128,129,6],[103,4,130,2],[103,5,130,3],[104,4,132,2],[104,10,132,8,"value"],[104,15,132,13],[104,18,132,16],[104,22,132,16,"useMemo"],[104,28,132,23],[104,29,132,23,"useMemo"],[104,36,132,23],[104,38,133,4],[104,45,133,11],[105,6,133,13,"user"],[105,10,133,17],[106,6,133,19,"token"],[106,11,133,24],[107,6,133,26,"loading"],[107,13,133,33],[108,6,133,35,"login"],[108,11,133,40],[109,6,133,42,"logout"],[110,4,133,49],[110,5,133,50],[110,6,133,51],[110,8,134,4],[110,9,134,5,"user"],[110,13,134,9],[110,15,134,11,"token"],[110,20,134,16],[110,22,134,18,"loading"],[110,29,134,25],[110,30,135,2],[110,31,135,3],[111,4,137,2],[111,24,137,9],[111,28,137,9,"_reactJsxDevRuntime"],[111,47,137,9],[111,48,137,9,"jsxDEV"],[111,54,137,9],[111,56,137,10,"AuthContext"],[111,67,137,21],[111,68,137,22,"Provider"],[111,76,137,30],[112,6,137,31,"value"],[112,11,137,36],[112,13,137,38,"value"],[112,18,137,44],[113,6,137,44,"children"],[113,14,137,44],[113,16,137,46,"children"],[114,4,137,54],[115,6,137,54,"fileName"],[115,14,137,54],[115,16,137,54,"_jsxFileName"],[115,28,137,54],[116,6,137,54,"lineNumber"],[116,16,137,54],[117,6,137,54,"columnNumber"],[117,18,137,54],[118,4,137,54],[118,11,137,77],[118,12,137,78],[119,2,138,0],[119,3,138,1],[120,2,140,7],[120,8,140,13,"useAuth"],[120,15,140,20],[120,18,140,23,"useAuth"],[120,19,140,23],[120,24,140,47],[121,4,141,2],[121,10,141,8,"ctx"],[121,13,141,11],[121,16,141,14],[121,20,141,14,"useContext"],[121,26,141,24],[121,27,141,24,"useContext"],[121,37,141,24],[121,39,141,25,"AuthContext"],[121,50,141,36],[121,51,141,37],[122,4,142,2],[122,8,142,6],[122,9,142,7,"ctx"],[122,12,142,10],[122,14,142,12],[123,6,143,4],[123,12,143,10],[123,16,143,14,"Error"],[123,21,143,19],[123,22,143,20],[123,64,143,62],[123,65,143,63],[124,4,144,2],[125,4,145,2],[125,11,145,9,"ctx"],[125,14,145,12],[126,2,146,0],[126,3,146,1],[127,0,146,2],[127,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","init","login","logout","useMemo$argument_0","useAuth"],"mappings":"AAA;qECwC;YCQ;iBCC;KD8B;GDG;gBGG;GHgC;iBIG;GJS;IKG,+CL;CDK;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}